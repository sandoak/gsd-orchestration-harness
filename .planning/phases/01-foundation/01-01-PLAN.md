---
phase: 01-foundation
plan: 01
type: execute
---

<objective>
Convert single-package setup to pnpm monorepo with workspace configuration.

Purpose: Establish the monorepo foundation that all subsequent packages will build upon.
Output: Working pnpm workspace with packages/ directory structure ready for core package.
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-phase.md
./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@package.json

**Project structure (from PROJECT.md):**

```
gsd-orchestration-harness/
├── package.json                 # Monorepo root
├── pnpm-workspace.yaml
├── packages/
│   ├── core/                    # Shared types and utilities
│   ├── mcp-server/              # MCP server (stdio)
│   ├── web-server/              # HTTP + WebSocket
│   └── dashboard/               # React + Vite
```

**Constraints:**

- Monorepo with pnpm workspaces
- Node.js >=22.0.0 <25.0.0
- TypeScript 5.x strict mode
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Install pnpm and convert to workspace</name>
  <files>pnpm-workspace.yaml, package.json</files>
  <action>
    1. Ensure pnpm is available (corepack enable pnpm or npm install -g pnpm)
    2. Create pnpm-workspace.yaml with packages glob: packages/*
    3. Update root package.json:
       - Add "private": true (monorepo roots must be private)
       - Remove "main" and "type" fields (root doesn't export)
       - Keep devDependencies at root (shared tooling)
       - Keep scripts at root (workspace-wide commands)
       - Add workspaces field for compatibility
    4. Remove package-lock.json (switching to pnpm-lock.yaml)
    5. Create packages/ directory structure with placeholder .gitkeep files
    6. Run pnpm install to generate pnpm-lock.yaml

    Avoid: Don't delete node_modules manually - pnpm install will handle it.
    Avoid: Don't use npm/yarn commands after this - strictly pnpm.

  </action>
  <verify>
    - pnpm -v returns version
    - pnpm-workspace.yaml exists with correct content
    - pnpm install completes successfully
    - pnpm-lock.yaml is generated
  </verify>
  <done>
    - pnpm workspace initialized
    - Root package.json is private
    - packages/ directory exists
    - pnpm-lock.yaml generated
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure root TypeScript for monorepo</name>
  <files>tsconfig.json, tsconfig.base.json</files>
  <action>
    1. Create tsconfig.base.json with shared compiler options:
       - target: ES2022 (Node 22 supports)
       - module: NodeNext
       - moduleResolution: NodeNext
       - strict: true (all strict flags)
       - esModuleInterop: true
       - skipLibCheck: true
       - declaration: true
       - declarationMap: true
       - sourceMap: true
       - resolveJsonModule: true
       - isolatedModules: true (required for transpilers)

    2. Update root tsconfig.json:
       - Extend tsconfig.base.json
       - Add references to future packages (empty for now)
       - Add paths for workspace packages: "@gsd/*": ["packages/*/src"]

    3. The base config will be extended by each package's tsconfig.json

    Avoid: Don't set outDir in base config - each package sets its own.
    Avoid: Don't use composite: true in base - only in package configs.

  </action>
  <verify>
    - pnpm type-check passes (no errors)
    - tsconfig.base.json has strict: true
    - Root tsconfig.json extends base
  </verify>
  <done>
    - tsconfig.base.json created with strict settings
    - Root tsconfig.json configured for monorepo
    - Type checking works
  </done>
</task>

<task type="auto">
  <name>Task 3: Update build tooling for monorepo</name>
  <files>package.json, .gitignore</files>
  <action>
    1. Update root package.json scripts for workspace operations:
       - "build": "pnpm -r build" (recursive build all packages)
       - "dev": "pnpm -r --parallel dev" (parallel dev mode)
       - "test": "pnpm -r test" (recursive test)
       - "lint": "eslint . --ext .js,.jsx,.ts,.tsx" (keep at root)
       - "type-check": "pnpm -r type-check" (recursive type check)
       - "clean": "pnpm -r exec rm -rf dist" (clean all dist folders)

    2. Update .gitignore for monorepo:
       - Add packages/*/dist/
       - Add packages/*/.turbo/ (future-proofing)
       - Keep node_modules pattern

    3. Remove src/ directory if empty (monorepo packages will have their own)

    Avoid: Don't add turbo.json yet - simple pnpm scripts are sufficient for this project size.

  </action>
  <verify>
    - pnpm build runs (may warn about no packages yet, that's OK)
    - pnpm lint runs successfully
    - .gitignore covers workspace dist folders
  </verify>
  <done>
    - Root scripts updated for workspace operations
    - .gitignore updated for monorepo structure
    - Build tooling ready for packages
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] pnpm -v shows version
- [ ] pnpm-workspace.yaml exists
- [ ] pnpm install completes without errors
- [ ] pnpm type-check passes
- [ ] packages/ directory exists
- [ ] Root package.json has "private": true
</verification>

<success_criteria>

- pnpm monorepo structure established
- TypeScript configuration ready for packages
- Build scripts work with workspace commands
- Ready to create packages/core in next plan
  </success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
