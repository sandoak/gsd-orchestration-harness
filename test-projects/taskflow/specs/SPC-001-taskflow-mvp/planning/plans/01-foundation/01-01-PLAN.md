---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - pnpm-workspace.yaml
  - tsconfig.json
  - .gitignore
  - packages/shared/package.json
  - packages/shared/tsconfig.json
  - packages/shared/src/types.ts
  - packages/shared/src/index.ts
autonomous: true
must_haves:
  truths:
    - 'pnpm workspace is configured'
    - 'Shared types package exists'
    - 'Task interface is defined'
  artifacts:
    - path: 'package.json'
      provides: 'Monorepo root configuration'
      contains: 'private'
    - path: 'pnpm-workspace.yaml'
      provides: 'Workspace package definitions'
    - path: 'packages/shared/src/types.ts'
      provides: 'Task and API type definitions'
      exports: ['Task', 'CreateTaskInput', 'ApiResponse']
  key_links: []
must_pass:
  - id: file-exists-package
    type: file_exists
    path: package.json
  - id: file-exists-workspace
    type: file_exists
    path: pnpm-workspace.yaml
  - id: file-exists-types
    type: file_exists
    path: packages/shared/src/types.ts
---

<objective>
Initialize pnpm monorepo structure with root configuration and shared types package.

Purpose: Establish the monorepo foundation that both API and web packages will build upon.
Output: Working pnpm workspace with shared types package ready for consumption.
</objective>

<execution_context>
@.harness/skills/workflows/execute-plan.md
@.harness/skills/templates/summary.md
</execution_context>

<context>
@specs/SPC-001-taskflow-mvp/SPEC.md
@specs/SPC-001-taskflow-mvp/ROADMAP.md

**Project structure:**

```
taskflow/
├── package.json             # Monorepo root
├── pnpm-workspace.yaml
├── packages/
│   ├── api/                 # Express backend
│   ├── web/                 # React frontend
│   └── shared/              # Shared types
```

**Constraints:**

- Monorepo with pnpm workspaces
- Node.js >=20.0.0
- TypeScript 5.x strict mode
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Create root monorepo configuration</name>
  <files>package.json, pnpm-workspace.yaml, tsconfig.json, .gitignore</files>
  <action>
    1. Create package.json with:
       - name: "taskflow", version: "0.0.1", private: true
       - type: "module"
       - Scripts: dev (pnpm -r --parallel dev), build, test, lint
       - devDependencies: typescript ^5.3.0
       - engines: node >=20.0.0

    2. Create pnpm-workspace.yaml:
       packages: ["packages/*"]

    3. Create tsconfig.json with:
       - target: ES2022, module: ESNext, moduleResolution: bundler
       - strict: true, esModuleInterop: true, skipLibCheck: true
       - declaration: true, declarationMap: true, sourceMap: true

    4. Create .gitignore:
       node_modules/, dist/, .env, .env.local, *.log, .DS_Store, coverage/

    Avoid: Don't add workspaces field to package.json - pnpm-workspace.yaml handles this.

  </action>
  <verify>
    - ls package.json pnpm-workspace.yaml tsconfig.json .gitignore
    - All files exist
  </verify>
  <done>
    - Root package.json created with private: true
    - pnpm workspace configured
    - TypeScript base config ready
    - Gitignore configured
  </done>
</task>

<task type="auto">
  <name>Task 2: Create shared types package</name>
  <files>packages/shared/package.json, packages/shared/tsconfig.json, packages/shared/src/types.ts, packages/shared/src/index.ts</files>
  <action>
    1. Create packages/shared/package.json:
       - name: "@taskflow/shared", version: "0.0.1"
       - type: "module"
       - main: "./dist/index.js", types: "./dist/index.d.ts"
       - exports: { ".": { types, import } }
       - scripts: build (tsc), dev (tsc --watch)

    2. Create packages/shared/tsconfig.json:
       - extends: "../../tsconfig.json"
       - compilerOptions: { outDir: "./dist", rootDir: "./src" }
       - include: ["src/**/*"]

    3. Create packages/shared/src/types.ts:
       ```typescript
       export interface Task {
         id: string;
         title: string;
         description?: string;
         completed: boolean;
         createdAt: string;
         updatedAt: string;
       }

       export interface CreateTaskInput {
         title: string;
         description?: string;
       }

       export interface UpdateTaskInput {
         title?: string;
         description?: string;
         completed?: boolean;
       }

       export interface ApiResponse<T> {
         data: T;
         error?: string;
       }
       ```

    4. Create packages/shared/src/index.ts:
       export * from './types.js';

    Avoid: Don't forget .js extension in ESM imports.

  </action>
  <verify>
    - ls packages/shared/package.json packages/shared/src/types.ts
    - pnpm --filter @taskflow/shared build (if pnpm available)
  </verify>
  <done>
    - Shared types package created
    - Task, CreateTaskInput, UpdateTaskInput, ApiResponse types defined
    - Package compiles successfully
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] package.json exists with "private": true
- [ ] pnpm-workspace.yaml exists with packages/*
- [ ] tsconfig.json exists with strict mode
- [ ] packages/shared/package.json exists
- [ ] packages/shared/src/types.ts defines Task interface
</verification>

<success_criteria>

- Monorepo structure established
- Shared types package created
- Ready to scaffold API and web packages
  </success_criteria>

<output>
After completion, create `specs/SPC-001-taskflow-mvp/execution/phases/01-foundation/01-01-SUMMARY.md`
</output>
