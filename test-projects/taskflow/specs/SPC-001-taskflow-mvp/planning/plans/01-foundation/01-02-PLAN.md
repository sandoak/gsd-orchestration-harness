---
phase: 01-foundation
plan: 02
type: execute
wave: 2
depends_on: ['01-01']
files_modified:
  - packages/api/package.json
  - packages/api/tsconfig.json
  - packages/api/src/index.ts
autonomous: true
must_haves:
  truths:
    - 'Express server runs on port 3001'
    - 'Health endpoint returns status ok'
    - 'CORS is enabled'
  artifacts:
    - path: 'packages/api/package.json'
      provides: 'API package configuration'
      contains: '@taskflow/api'
    - path: 'packages/api/src/index.ts'
      provides: 'Express server entry point'
      exports: ['app']
  key_links:
    - from: 'packages/api/package.json'
      to: '@taskflow/shared'
      via: 'workspace dependency'
must_pass:
  - id: file-exists-api-package
    type: file_exists
    path: packages/api/package.json
  - id: file-exists-api-index
    type: file_exists
    path: packages/api/src/index.ts
  - id: build-succeeds
    type: build_succeeds
    command: pnpm --filter @taskflow/api build
---

<objective>
Create the Express.js backend package with basic server setup.

Purpose: Establish the API server foundation that will serve task CRUD endpoints.
Output: Working Express server responding to /api/health endpoint.
</objective>

<execution_context>
@.harness/skills/workflows/execute-plan.md
@.harness/skills/templates/summary.md
</execution_context>

<context>
@specs/SPC-001-taskflow-mvp/SPEC.md
@specs/SPC-001-taskflow-mvp/ROADMAP.md
@specs/SPC-001-taskflow-mvp/execution/phases/01-foundation/01-01-SUMMARY.md

**API package structure:**

```
packages/api/
├── package.json
├── tsconfig.json
├── src/
│   ├── index.ts       # Express server entry
│   ├── db/            # Database layer (Phase 2)
│   └── routes/        # API routes (Phase 2)
└── tests/
```

</context>

<tasks>

<task type="auto">
  <name>Task 1: Create API package configuration</name>
  <files>packages/api/package.json, packages/api/tsconfig.json</files>
  <action>
    1. Create packages/api/package.json:
       ```json
       {
         "name": "@taskflow/api",
         "version": "0.0.1",
         "type": "module",
         "main": "./dist/index.js",
         "scripts": {
           "dev": "tsx watch src/index.ts",
           "build": "tsc",
           "start": "node dist/index.js",
           "test": "vitest run"
         },
         "dependencies": {
           "@taskflow/shared": "workspace:*",
           "express": "^4.18.2",
           "better-sqlite3": "^11.0.0",
           "uuid": "^9.0.0",
           "cors": "^2.8.5"
         },
         "devDependencies": {
           "@types/express": "^4.17.21",
           "@types/better-sqlite3": "^7.6.8",
           "@types/cors": "^2.8.17",
           "@types/uuid": "^9.0.0",
           "tsx": "^4.7.0",
           "vitest": "^1.2.0"
         }
       }
       ```

    2. Create packages/api/tsconfig.json:
       ```json
       {
         "extends": "../../tsconfig.json",
         "compilerOptions": {
           "outDir": "./dist",
           "rootDir": "./src"
         },
         "include": ["src/**/*"]
       }
       ```

  </action>
  <verify>
    - ls packages/api/package.json packages/api/tsconfig.json
  </verify>
  <done>
    - API package.json created with dependencies
    - TypeScript config extends root
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Express server entry point</name>
  <files>packages/api/src/index.ts</files>
  <action>
    Create packages/api/src/index.ts:

    ```typescript
    import express from 'express';
    import cors from 'cors';

    const app = express();
    const PORT = process.env.PORT || 3001;

    app.use(cors());
    app.use(express.json());

    // Health check
    app.get('/api/health', (_req, res) => {
      res.json({ status: 'ok', timestamp: new Date().toISOString() });
    });

    // Placeholder for task routes (added in Phase 2)
    app.get('/api/tasks', (_req, res) => {
      res.json({ data: [], message: 'Task routes not yet implemented' });
    });

    app.listen(PORT, () => {
      console.log(`API server running on port ${PORT}`);
    });

    export { app };
    ```

    Create packages/api/src/db/.gitkeep (placeholder for Phase 2)
    Create packages/api/src/routes/.gitkeep (placeholder for Phase 2)

  </action>
  <verify>
    - ls packages/api/src/index.ts
    - pnpm --filter @taskflow/api build
  </verify>
  <done>
    - Express server created
    - Health endpoint available at /api/health
    - Ready for database layer in Phase 2
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] packages/api/package.json exists
- [ ] packages/api/tsconfig.json extends root
- [ ] packages/api/src/index.ts creates Express server
- [ ] pnpm --filter @taskflow/api build succeeds
</verification>

<success_criteria>

- API package builds successfully
- Server exports app for testing
- Ready for database layer in Phase 2
  </success_criteria>

<output>
After completion, create `specs/SPC-001-taskflow-mvp/execution/phases/01-foundation/01-02-SUMMARY.md`
</output>
